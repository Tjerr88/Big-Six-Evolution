<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Big Six Evolution</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #111827; color: #f9fafb; font-size: 1.1rem; }
    .test-session { background-color: #374151; border: 3px solid #f59e0b; }
    .regular-session { background-color: #1f2937; border: 2px solid #4b5563; }
    button { transition: background 0.2s; }
    .scroll-box { max-height: 70vh; overflow-y: auto; white-space: pre-line; }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-2">
  <div id="root" class="w-full max-w-md"></div>

  <script type="text/babel">
    /* ------------------------------
       Big Six Evolution generator
    ------------------------------ */

    const patterns = {
      "Swing Pattern": ["One-Legged Deadlift", "Double Sumo Deadlift", "Single Leg Glute Bridge",
        "One-arm Swing", "(Side Stepping) Two-arm Swing", "Double Swing"],
      "Get Up Pattern": ["(3 Min) Get Up", "Supine to Sit Up", "Windmill",
        "Bent Press", "Supine to Half Kneel", "Half Kneel to Stand"],
      "Clean Pattern": ["HS-Plank", "Front Rack Carry", "Single Dead Clean",
        "Double Clean", "Pull Up/Chin Up", "One-arm Row"],
      "Squat Pattern": ["B-stance Goblet Squat", "Single Front Squat", "Paused Front Squat",
        "Double Front Squat", "Athletic Lunge", "Bottom Up Squat"],
      "Press Pattern": ["Military Press", "Top Down Press", "Half Kneeling Press",
        "Floor Press", "Double Push Press", "Double Push Jerk"],
      "Snatch Pattern": ["Overhead Carry", "Snatch", "Low Pull Snatch",
        "High Pull", "Front/Side Raise Snatch", "Double Snatch"],
      "Hybrid Pattern": ["Double Clean & Press", "Double Clean & Front Squat", "Double Snatch & Overhead Walk",
        "Double Clean & Jerk", "Double Snatch & Press", "Double Front Squat & Push Press"]
    };

    const cycleVolumes = {
      1: { low: 10, medium: 20, high: 30 },
      2: { low: 15, medium: 25, high: 40 },
      3: { low: 20, medium: 30, high: 50 }
    };

    const swingLadderExercises = ["One-arm Swing", "(Side Stepping) Two-arm Swing", "Snatch", "High Pull"];
    const evenLadderExercises = ["Double Push Press", "Double Push Jerk", "Double Clean", "Double Swing", "Double Snatch", "Double Front Squat"];
    const timeBasedExercises = ["Overhead Carry", "Front Rack Carry", "HS-Plank"];
    const hybridExercises = ["Double Clean & Press", "Double Clean & Front Squat", "Double Snatch & Overhead Walk",
      "Double Clean & Jerk", "Double Snatch & Press", "Double Front Squat & Push Press"];

    const randomChoice = arr => arr[Math.floor(Math.random() * arr.length)];

    function calculateVolume(exercise, volumeType, cycle) {
      const base = cycleVolumes[cycle][volumeType];

      if (exercise === "(3 Min) Get Up") {
        if (volumeType === "low") return cycle;
        if (volumeType === "medium") return cycle + 1;
        if (volumeType === "high") return cycle + 2;
      }

      if (hybridExercises.includes(exercise)) return cycleVolumes[cycle]["low"];

      if (timeBasedExercises.includes(exercise)) {
        const timeMap = {
          1: { low: 30, medium: 60, high: 90 },
          2: { low: 45, medium: 75, high: 105 },
          3: { low: 60, medium: 90, high: 120 }
        };
        return timeMap[cycle][volumeType];
      }

      return base;
    }

    function getLadderPattern(exercise, volume, cycle) {
      if (timeBasedExercises.includes(exercise)) return [`${volume} sec`, volume];

      if (hybridExercises.includes(exercise)) {
        if (cycle === 1) return ["1-2-3-4", 10];
        if (cycle === 2) return ["1-2-3-4-5", 15];
        if (cycle === 3) return ["2x 1-2-3-4", 20];
      }

      if (swingLadderExercises.includes(exercise)) {
        const map = {
          1: {10:"10",20:"5-15",30:"5-10-15"},
          2: {15:"5-10",25:"10-15",40:"5-15-20"},
          3: {20:"5-15",30:"10-20",50:"10-15-25"}
        };
        return [map[cycle][volume] || `${volume}`, volume];
      }

      if (evenLadderExercises.includes(exercise)) {
        const map = {
          1: {10:"4-6",20:"2-4-6-8",30:"2-4-6-8-10"},
          2: {15:"2-4-6 + 1-2",25:"2x 2-4-6 + 1",40:"2-4-6-8-10 + 2-4-6"},
          3: {20:"2-4-6-8",30:"2-4-6-8-10",50:"2x 2-4-6-8 + 2-4"}
        };
        return [map[cycle][volume] || `${volume}`, volume];
      }

      const map = {
        1: {10:"1-2-3-4",20:"2x 1-2-3-4",30:"3x 1-2-3-4"},
        2: {15:"1-2-3-4-5",25:"1-2-3-4-5 + 1-2-3-4",40:"2x 1-2-3-4-5 + 1-2-3-4"},
        3: {20:"2x 1-2-3-4",30:"2x 1-2-3-4-5",50:"3x 1-2-3-4-5 + 1-2"}
      };
      return [map[cycle][volume] || `${volume} reps`, volume];
    }

    function getVolumeFormat(exercise, volume, cycle) {
      const [pattern, total] = getLadderPattern(exercise, volume, cycle);
      if (timeBasedExercises.includes(exercise)) return pattern;
      return `${total} reps (${pattern})`;
    }

    function generateProgram() {
      let sessions = [];
      let lastExercises = [];
      let lastVolumes = {};

      for (let cycle = 1; cycle <= 3; cycle++) {
        for (let i = 1; i <= 36; i++) {
          const patternsList = Object.keys(patterns).sort(() => Math.random() - 0.5);
          let currentVolTypes = {};

          for (let pattern of patternsList) {
            let choices = patterns[pattern].filter(ex => !lastExercises.includes(ex));
            if (choices.length === 0) choices = patterns[pattern];
            const exercise = randomChoice(choices);

            let types = ["low", "medium", "high"];
            if (hybridExercises.includes(exercise)) types = ["low"];
            const volumeType = randomChoice(types);

            const vol = calculateVolume(exercise, volumeType, cycle);

            sessions.push({
              session: i,
              cycle,
              pattern,
              exercise,
              volumeType,
              volume: vol,
              formattedVolume: getVolumeFormat(exercise, vol, cycle),
              order: patternsList.indexOf(pattern) + 1
            });

            currentVolTypes[pattern] = volumeType;
          }
          lastExercises = sessions.slice(-7).map(s => s.exercise);
          lastVolumes = currentVolTypes;
        }

        const testSession = [
          { exercise: "One-arm Swing", formattedVolume: "10 reps per hand" },
          { exercise: "Get Up", formattedVolume: "1 rep per hand" },
          { exercise: "Double Clean", formattedVolume: "5 reps" },
          { exercise: "Military Press", formattedVolume: "5 reps per hand" },
          { exercise: "Double Front Squat", formattedVolume: "5 reps" },
          { exercise: "Snatch", formattedVolume: "5 reps per hand" }
        ].map((ex, idx) => ({
          session: 37,
          cycle,
          pattern: "Test Session",
          ...ex,
          volumeType: "test",
          volume: null,
          order: idx + 1
        }));
        sessions.push(...testSession);
      }

      return sessions;
    }

    /* ------------------------------
       Recovery protocollen
    ------------------------------ */
    const OS_RESET = `20 cross crawl
2 minutes breathe with Diaphragm
20 neck nods, on 5th and 15th keep your chin tucked and breathe diaphragmatacilly 5 times, on 10th and 20th keep chin up and breathe diaphragmatacilly 5 times
Segmental rolls, 3 per limb
20 Rocking, 10 in plantair 10 in dorsiflexion
2 minutes Baby crawl

Watch the tongue with all the exercises`;

    const GFM_MOBILITY = `Ground Force Method General Mobility

Hips
Figure 4 position, figure 4 lunge, half heel sit,
Z position switches and Z position side roll,
Hip Openers - Prone to TGU to Bridge.

Shoulders
The Egyptian - Seated, Pike, Prone
S movement - Seated, Pike, Prone
Figure 8 in Crawl - 6 point & 4 point
Crawl to crab
Pike to tabletop

Ankles
Ankle series - Up & down, in & out, Rotations
Figure 8’s toes and ankle
Snail
Crawl-frog-crab transitions.

Spine & Neck
Supine neck rolls - Left to right
Hand on knee rolling
Segmental rolling - Neck, arms & legs
Forwards and backwards rolling

Wrists
Finger waves
Hand circles
Tea pot`;

    const KB_MOBILITY = `Kettlebell Mobility

Arm Bar
2/3 Bent Arm Bar
3/5 Rib Pull
3/5 Bretzel
3/5 Windmill
3/3 Bent Press
Pump Stretch
Tactical Frog
10 Overhead Hip Flexor Stretch
5 Prying Goblet Squat
3/5 Cossack Squat
5/10 Goodmorning Hamstring Stretch
5/10 Kettlebell Pull over
3/5 Get Up High Bridge
5 Tall kneeling Halo
3 Tall Kneeling Rotations

Nummers zijn de reps`;

    const FULL_REST_ADVICE = `Volledige rustdag advies:

- Slaap: probeer 8 uur te halen
- Hydratatie: minimaal 2 liter water
- Voeding: focus op eiwit en micronutriënten
- Optioneel: korte wandeling of ademhalingsoefeningen
- Vermijd zware inspanning en focus op herstel`;

    /* ------------------------------
       React component
    ------------------------------ */
    function App() {
      const [program, setProgram] = React.useState(() =>
        JSON.parse(localStorage.getItem("b6e_program")) || null
      );
      const [index, setIndex] = React.useState(() =>
        JSON.parse(localStorage.getItem("b6e_index")) || 0
      );
      const [history, setHistory] = React.useState(() =>
        JSON.parse(localStorage.getItem("b6e_history")) || []
      );
      const [mode, setMode] = React.useState("check");
      const [recoveryFlow, setRecoveryFlow] = React.useState("");

      const startProgram = () => {
        const prog = generateProgram();
        setProgram(prog);
        setIndex(0);
        localStorage.setItem("b6e_program", JSON.stringify(prog));
        localStorage.setItem("b6e_index", 0);
      };

      const markComplete = () => {
        const currentSession = program.slice(index, index + 7);
        const now = new Date();
        const entry = {
          date: now.toLocaleString(),
          type: `B6E – Cyclus ${currentSession[0].cycle}, Sessie ${currentSession[0].session}`
        };
        const updatedHistory = [...history, entry];
        setHistory(updatedHistory);
        localStorage.setItem("b6e_history", JSON.stringify(updatedHistory));

        const next = index + 7;
        setIndex(next);
        localStorage.setItem("b6e_index", next);
        setMode("check");
      };

      const logRecovery = (type) => {
        const now = new Date();
        const entry = { date: now.toLocaleString(), type: `Recovery: ${type}` };
        const updatedHistory = [...history, entry];
        setHistory(updatedHistory);
        localStorage.setItem("b6e_history", JSON.stringify(updatedHistory));
        setMode("check");
      };

      const logRestDay = () => {
        const now = new Date();
        const entry = { date: now.toLocaleString(), type: "Full Rest Day" };
        const updatedHistory = [...history, entry];
        setHistory(updatedHistory);
        localStorage.setItem("b6e_history", JSON.stringify(updatedHistory));
        setMode("check");
      };

      /* Screens */
      if (!program) {
        return (
          <div className="text-center space-y-6">
            <h1 className="text-3xl font-bold">Big Six Evolution</h1>
            <button onClick={startProgram} className="w-full py-4 bg-green-600 rounded-xl text-xl font-semibold hover:bg-green-700">
              Start Programma
            </button>
          </div>
        );
      }

      if (mode === "check") {
        return (
          <div className="space-y-6 text-center">
            <h2 className="text-2xl font-bold">Hoe voel je je vandaag?</h2>
            <button onClick={() => setMode("training")} className="w-full py-3 bg-green-600 rounded-xl text-lg hover:bg-green-700">Super</button>
            <button onClick={() => setMode("training")} className="w-full py-3 bg-blue-600 rounded-xl text-lg hover:bg-blue-700">Prima</button>
            <button onClick={() => setMode("recoveryChoice")} className="w-full py-3 bg-yellow-600 rounded-xl text-lg hover:bg-yellow-700">Niet fit maar wil bewegen</button>
            <button onClick={() => setMode("rest")} className="w-full py-3 bg-gray-600 rounded-xl text-lg hover:bg-gray-700">Volledige rustdag</button>

            <div className="pt-6">
              <h3 className="text-xl font-bold mb-2">Historie</h3>
              {history.length === 0 ? (
                <p className="text-gray-400">Nog geen sessies</p>
              ) : (
                <ul className="space-y-1 max-h-48 overflow-y-auto">
                  {history.slice().reverse().map((h, i) => (
                    <li key={i} className="bg-gray-700 rounded p-2 text-sm">{h.date} – {h.type}</li>
                  ))}
                </ul>
              )}
            </div>
          </div>
        );
      }

      if (mode === "training") {
        const currentSession = program.slice(index, index + 7);
        const isTest = currentSession[0]?.pattern === "Test Session";
        return (
          <div className="space-y-6">
            <h2 className="text-2xl font-bold text-center">
              {isTest ? "Testdag" : `Sessie ${currentSession[0].session}`} – Cyclus {currentSession[0].cycle}
            </h2>
            <div className={`p-4 rounded-xl shadow-md ${isTest ? "test-session" : "regular-session"}`}>
              {currentSession.map((ex, i) => (
                <div key={i} className="mb-3">
                  <div className="font-bold text-lg">{ex.pattern}</div>
                  <div className="text-base">{ex.exercise} – {ex.formattedVolume}</div>
                </div>
              ))}
            </div>
            <button onClick={markComplete} className="w-full py-4 bg-blue-600 rounded-xl text-lg font-semibold hover:bg-blue-700">
              Voltooid
            </button>
          </div>
        );
      }

      if (mode === "recoveryChoice") {
        return (
          <div className="space-y-6 text-center">
            <h2 className="text-2xl font-bold">Welke hersteltraining kies je?</h2>
            <button onClick={() => {setRecoveryFlow(OS_RESET); setMode("recovery");}} className="w-full py-3 bg-green-600 rounded-xl text-lg hover:bg-green-700">OS Reset</button>
            <button onClick={() => {setRecoveryFlow(GFM_MOBILITY); setMode("recovery
